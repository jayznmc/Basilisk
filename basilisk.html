<!DOCTYPE html>
<html>
    <head>
        <title>Basilisk</title>
        <link rel="stylesheet" href="style.css"></link>
    </head>
    <body>
        <h2>Project Basilisk</h2>

        <canvas id="gameCanvas" width="300" height="300"></canvas>
        <script>
            const CANVAS_BORDER_COLOUR = 'black';
            const CANVAS_BACKGROUND_COLOUR = 'grey';
            const BASILISK_SKIN = 'purple';
            const BASILISK_BORDER = 'red';
            const DELAY = 100;

            var gameCanvas = document.getElementById("gameCanvas");
            var ctx = gameCanvas.getContext("2d");

            //Create an array of coordinates, starting point. 5 pieces long
                        let basilisk = [
                            {x: 150, y: 150},
                            {x: 140, y: 150},
                            {x: 130, y: 150},
                            {x: 120, y: 150},
                            {x: 110, y: 150},
                        ];
            ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;
            ctx.strokestyle = CANVAS_BORDER_COLOUR;

            ctx.fillRect(0,0,gameCanvas.width,gameCanvas.height);
            ctx.strokeRect(0,0,gameCanvas.width,gameCanvas.height);        
            

            // Directional velocity
            let dx = 10;
            let dy = 0;

            //start
            main();

            //init key listener
            document.addEventListener("keydown", changeDirection);

            function main(){
               setTimeout(function onTick() {
                    clearCanvas();
                    moveBasilisk();
                    drawBasilisk();


                    //Call again
                    main();
                }, DELAY) 
            }


            // Change x-coord based on horizontal velocity, change y-coord based on vertical velocity
            function moveBasilisk(){
                const head = {x : basilisk[0].x + dx, y: basilisk[0].y + dy};

                // Insert head at start of array
                basilisk.unshift(head);

                // Remove last element
                basilisk.pop();
            }

            // Loop function that builds Basilisk with body parts
            function drawBasilisk(){
                basilisk.forEach(drawPart);
            }

            //Draw body piece object on canvas
            function drawPart(bodyPart){
                //Set colour
                ctx.fillStyle = BASILISK_SKIN;
                ctx.strokestyle = BASILISK_BORDER;

                //draw part at coordinates
                ctx.fillRect(bodyPart.x, bodyPart.y, 10,10);
                ctx.strokeRect(bodyPart.x,bodyPart.y,10,10);
            }

            // Control basilisk direction with keyboard
            function changeDirection(event){
                if (event.code == 'ArrowLeft'){
                    dx = -10;
                    dy = 0;
                }

                if (event.code == 'ArrowRight'){
                    dx = 10;
                    dy = 0;
                }

                if (event.code == 'ArrowUp'){
                    dx = 0;
                    dy = -10;
                }

                if (event.code == 'ArrowDown'){
                    dx = 0;
                    dy = 10;
                }



            }

            // Clear the screen, removes previous states.
            function clearCanvas(){
                ctx.fillStyle = 'grey';
                ctx.strokestyle = 'black';

                ctx.fillRect(0,0, gameCanvas.width, gameCanvas.height);
                ctx.strokeRect(0,0, gameCanvas.width, gameCanvas.height);
            }
             


        </script>

    </body>
</html>
